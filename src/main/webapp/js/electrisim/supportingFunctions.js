function waitForData(e=1e4){return new Promise((t,r)=>{const n=Date.now(),o=Math.ceil(e/100);let a=0;!function checkData(){a++;const i=Date.now()-n;if(globalPandaPowerData)console.log(`‚úÖ Data loaded after ${a} attempts (${i}ms)`),t(globalPandaPowerData);else if(i>=e||a>=o){const e=new Error(`Timeout waiting for data after ${i}ms (${a} attempts)`);console.error("‚ùå waitForData timeout:",e),r(e)}else setTimeout(checkData,100)}()})}function findVertexByBusId(e,t,r){const n=e.getChildCells(t,!0,!1);for(let e=0;e<n.length;e++){const t=n[e];if("PandapowerNet"!==t.value&&String(t.value.attributes[0].nodeValue)===String(r))return t}return null}"undefined"==typeof globalPandaPowerData&&(window.globalPandaPowerData=null),"undefined"==typeof safeJsonParse&&(window.safeJsonParse=e=>{try{return e?JSON.parse(e):[]}catch(e){return console.warn("Error parsing JSON:",e),[]}}),window.fetchPandaPowerData=function fetchPandaPowerData(){const e=`?_=${(new Date).getTime()}`;return fetch(`js/electrisim/models/example_simple.json${e}`,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}).then(e=>{if(console.log("Response:",e),!e.ok)throw new Error("Network response was not ok");return e.json()}).then(e=>(globalPandaPowerData=e,console.log("Data fetched and stored:",globalPandaPowerData),e)).catch(e=>{console.error("Error fetching data:",e)})},window.useDataToInsertOnGraph=function useDataToInsertOnGraph(e,t,n,o){waitForData().then(a=>{r(e,t,n,o,a)})},window.waitForData=waitForData,window.findVertexByBusId=findVertexByBusId;let e=[],t=!1;const r=(()=>{let r=null;return(n,o,a,i,s)=>{e.push({grafka:n,a:o,target:a,point:i,data:s}),r&&clearTimeout(r),r=setTimeout(async()=>{if(!t){t=!0;try{const t=e.length>20?3:5;for(;e.length>0;){const r=e.splice(0,t);for(const e of r)await insertComponentsForData(e.grafka,e.a,e.target,e.point,e.data);e.length>0&&await new Promise(e=>setTimeout(e,1))}}finally{t=!1}}},50)}})();async function insertComponentsForData(e,t,r,n,o){const a=Object.values(o._object).reduce((e,t)=>{try{const r=JSON.parse(t._object);return e+(r.data?r.data.length:0)}catch{return e}},0);a>50&&window.performanceOptimizer&&console.log(`üöÄ Processing ${a} components with optimizations...`);const i=safeJsonParse(o?._object?.ext_grid?._object),s=JSON.parse(o._object.gen._object),l=JSON.parse(o._object.sgen._object),c=JSON.parse(o._object.asymmetric_sgen._object),d=JSON.parse(o._object.line._object),m=JSON.parse(o._object.bus._object),y=JSON.parse(o._object.trafo._object),_=JSON.parse(o._object.trafo3w._object),g=JSON.parse(o._object.shunt._object),h=JSON.parse(o._object.load._object),p=JSON.parse(o._object.asymmetric_load._object),u=JSON.parse(o._object.impedance._object),x=JSON.parse(o._object.ward._object),$=JSON.parse(o._object.xward._object),f=JSON.parse(o._object.motor._object),v=JSON.parse(o._object.storage._object),X=JSON.parse(o._object.svc._object),b=JSON.parse(o._object.tcsc._object),E=JSON.parse(o._object.dcline._object);var D=e.view.scale,w=e.view.translate,L=n.x/D-w.x,S=n.y/D-w.y,P=e.getDefaultParent();e.getModel().beginUpdate();try{const t=m.data.length,r=new Array(t).fill().map(()=>[]),n=y.data.length;for(let e=0;e<n;e++){const n=y.data[e],[o,a,i,s]=n;i<t&&i>=0&&r[i].push(e),s<t&&s>=0&&r[s].push(e)}const o=Array.from({length:t},()=>new Array(t).fill(0));d.data.forEach(e=>{const[r,n,a,i]=e;a<t&&a>=0&&i<t&&i>=0&&(o[a][i]=1,o[i][a]=1)}),y.data.forEach(e=>{const[r,n,a,i]=e;a<t&&a>=0&&i<t&&i>=0&&(o[a][i]=2,o[i][a]=2)});const a=200,D=180,w=L+100,B=S+100,j={};for(let e=0;e<m.data.length;e++){const t=m.data[e],[r,n,o,a]=t,i=parseFloat(n);j[i]||(j[i]=[]),j[i].push({index:e,name:r,voltage:i})}const V=Object.keys(j).map(e=>parseFloat(e)).sort((e,t)=>t-e),k=[];for(let e=0;e<t;e++)k[e]={x:0,y:0};V.forEach((e,t)=>{const r=j[e],n=B+t*a,o=(r.length-1)*D,i=w-o/2;r.forEach((e,t)=>{const r=i+t*D;k[e.index]={x:r,y:n}})}),y.data.forEach(e=>{const[r,n,o,a]=e;if(o<t&&o>=0&&a<t&&a>=0){const e=m.data[o],t=m.data[a];if(parseFloat(e[1])!==parseFloat(t[1])){const e=(k[o].x+k[a].x)/2;k[o].x=e,k[a].x=e}}}),m.data.forEach((t,r)=>{const[n,o,a,i]=t,s=k[r].x,l=k[r].y,c=e.insertVertex(P,null,"",s,l,160,10,"line;strokeWidth=2;html=1;shapeELXXX=Bus;points=[[0,0.5],[0.05,0.5,0],[0.1,0.5,0],[0.15,0.5,0],[0.2,0.5,0],[0.25,0.5,0],[0.3,0.5,0],[0.35,0.5,0],[0.4,0.5,0],[0.45,0.5,0],[0.5,0.5,0],[0.55,0.5,0],[0.6,0.5,0],[0.65,0.5,0],[0.7,0.5,0],[0.75,0.5,0],[0.8,0.5,0],[0.85,0.5,0],[0.9,0.5,0],[0.95,0.5,0]]");configureBusAttributes(e,c,{name:`${n}`,vn_kv:`${o}`})}),y.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h,p,u,x,$,f,v,X,b,E,D,w]=t;if(a>=m.data.length||a<0||i>=m.data.length||i<0)return void console.warn(`Skipping transformer ${r} due to invalid bus indices: hv=${a}, lv=${i}`);let L=m.data[a][0],S=m.data[i][0];const B=findVertexByBusId(e,P,L),j=findVertexByBusId(e,P,S);if(B&&j){const t=B.geometry.x,r=B.geometry.y,a=(t+j.geometry.x)/2,i=(r+j.geometry.y)/2,m="shapeELXXX=Transformer; verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;strokeWidth=1;shape=mxgraph.electrical.signal_sources.current_source;",L=e.insertVertex(P,null,"",a,i,40,60,m);configureTransformerAttributes(e,L,{name:`${n}`,std_type:`${o}`,sn_mva:`${s}`,vn_hv_kv:`${l}`,vn_lv_kv:`${c}`,vk_percent:`${d}`,vkr_percent:`${y}`,pfe_kw:`${_}`,i0_percent:`${g}`,shift_degree:`${h}`,tap_side:`${p}`,tap_neutral:`${u}`,tap_min:`${x}`,tap_max:`${$}`,tap_step_percent:`${f}`,tap_step_degree:`${v}`,tap_pos:`${X}`,tap_phase_shifter:`${b}`,parallel:`${E}`,df:`${D}`,in_service:`${w}`});const S="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine",V="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.4;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine";e.insertEdge(P,null,"",L,B,S),e.insertEdge(P,null,"",L,j,V)}else console.warn(`Could not place transformer ${n}: One or both bus vertices not found`,{hv_bus:L,lv_bus:S,hvBusVertex:!!B,lvBusVertex:!!j})}),d.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h,p,u]=t,x=m.data[a][0],$=m.data[i][0],f=findVertexByBusId(e,P,x),v=findVertexByBusId(e,P,$);if(f&&v){let t;t="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=Line";const r=e.insertEdge(P,null,n,f,v,t);configureLineAttributes(e,r,{name:`${n}`,std_type:`${o}`,from_bus:`${a}`,to_bus:`${i}`,length_km:`${s}`,r_ohm_per_km:`${l}`,x_ohm_per_km:`${c}`,c_nf_per_km:`${d}`,g_us_per_km:`${y}`,max_i_ka:`${_}`,df:`${g}`,parallel:`${h}`,type:`${p}`,in_service:`${u}`})}else console.warn(`Could not create line ${n}: Bus vertices not found`,{from_bus:x,to_bus:$,fromBusVertex:f,toBusVertex:v})}),i.data.forEach((t,r)=>{const[n,o,a,i,s,l]=t;let c=m.data[o][0];const d=findVertexByBusId(e,P,c),y=d.geometry.x,_=d.geometry.y-80,g=e.insertVertex(P,null,"",y,_,70,58,"verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=externalGrid;shapeELXXX=External Grid");configureExternalGridAttributes(e,g,{name:`${n}`,vm_pu:`${a}`,va_degree:`${i}`,slack_weight:`${s}`,in_service:`${l}`}),d&&e.insertEdge(P,null,"",g,d,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),s.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h]=t;let p=m.data[o][0];const u=findVertexByBusId(e,P,p),x=30*r,$=u.geometry.x+x,f=u.geometry.y+80,v=e.insertVertex(P,null,"",$,f,45,45,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.signal_sources.ac_source;shapeELXXX=Generator");configureGeneratorAttributes(e,v,{name:`${n}`,bus_no:`${o}`,p_mw:`${a}`,vm_pu:`${i}`,sn_mva:`${s}`,min_q_mvar:`${l}`,max_q_mvar:`${c}`,scaling:`${d}`,slack:`${y}`,in_service:`${_}`,slack_weight:`${g}`,type:`${h}`}),u&&e.insertEdge(P,null,"",v,u,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),l.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y]=t;let _=m.data[o][0];const g=findVertexByBusId(e,P,_),h=40*r,p=g.geometry.x+h,u=g.geometry.y+120,x=e.insertVertex(P,null,"",p,u,45,45,"verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.rot_mech.synchro;shapeELXXX=Static Generator");configureStaticGeneratorAttributes(e,x,{name:`${n}`,p_mw:`${a}`,q_mvar:`${i}`,sn_mva:`${s}`,scaling:`${l}`,in_service:`${c}`,type:`${d}`,current_source:`${y}`}),g&&e.insertEdge(P,null,"",x,g,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),c.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h,p]=t;let u=m.data[o][0];const x=findVertexByBusId(e,P,u),$=x.geometry.x+60,f=x.geometry.y+60,v=e.insertVertex(P,null,"",$,f,45,45,"verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.rot_mech.asymmetric;shapeELXXX=Asymmetric Static Generator");configureStaticGeneratorAttributes(e,v,{name:`${n}`,p_a_mw:`${a}`,q_a_mvar:`${i}`,p_b_mw:`${s}`,q_b_mvar:`${l}`,p_c_mw:`${c}`,q_c_mvar:`${d}`,sn_mva:`${y}`,scaling:`${_}`,in_service:`${g}`,type:`${h}`,current_source:`${p}`}),x&&e.insertEdge(P,null,"",v,x,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),_.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h,p,u,x,$,f,v,X,b,E,D,w,L,S,B,j,V,k]=t;let N=m.data[a][0],A=m.data[i][0],Y=m.data[s][0];const I=findVertexByBusId(e,P,N),z=findVertexByBusId(e,P,A),O=findVertexByBusId(e,P,Y),J=I.geometry.x+60,C=O.geometry.y-120,q=e.insertVertex(P,null,"",J,C,40,60,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.inductors.pot_trans_3_windings;shapeELXXX=Three Winding Transformer");configureTransformerAttributes(e,q,{name:`${n}`,std_type:`${o}`,sn_hv_mva:`${l}`,sn_mv_mva:`${c}`,sn_lv_mva:`${d}`,vn_hv_kv:`${y}`,vn_mv_kv:`${_}`,vn_lv_kv:`${g}`,vk_hv_percent:`${h}`,vk_mv_percent:`${p}`,vk_lv_percent:`${u}`,vkr_hv_percent:`${x}`,vkr_mv_percent:`${$}`,vkr_lv_percent:`${f}`,pfe_kw:`${v}`,i0_percent:`${X}`,shift_mv_degree:`${b}`,tap_side:`${E}`,tap_neutral:`${D}`,tap_min:`${w}`,tap_max:`${L}`,tap_step_percent:`${S}`,tap_step_degree:`${B}`,tap_pos:`${j}`,tap_at_star_point:`${V}`,in_service:`${k}`}),I&&e.insertEdge(P,null,"",q,I,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine"),z&&e.insertEdge(P,null,"",q,z,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.4;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine"),O&&e.insertEdge(P,null,"",q,O,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.4;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),g.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d]=t;let y=m.data[n][0];const _=findVertexByBusId(e,P,y),g=_.geometry.x+60,h=_.geometry.y+60,p=e.insertVertex(P,null,"",g,h,30,20,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.signal_sources.signal_ground;shapeELXXX=Shunt Reactor");configureShuntReactorAttributes(e,p,{name:`${o}`,q_mvar:`${a}`,p_mw:`${i}`,vn_kv:`${s}`,step:`${l}`,max_step:`${c}`,in_service:`${d}`}),_&&e.insertEdge(P,null,"",p,_,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),h.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y]=t;let _=m.data[o][0];const g=findVertexByBusId(e,P,_),h=35*r,p=g.geometry.x-60+h,u=g.geometry.y+80,x=e.insertVertex(P,null,"",p,u,30,20,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.signal_sources.signal_ground;shapeELXXX=Load");configureLoadAttributes(e,x,{name:`${n}`,p_mw:`${a}`,q_mvar:`${i}`,const_z_percent:`${s}`,const_i_percent:`${l}`,sn_mva:`${c}`,scaling:`${d}`,type:`${y}`}),g&&e.insertEdge(P,null,"",x,g,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),p.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h]=t;let p=m.data[o][0];const u=findVertexByBusId(e,P,p),x=u.geometry.x+60,$=u.geometry.y+60,f=e.insertVertex(P,null,"",x,$,30,20,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.signal_sources.signal_ground;shapeELXXX=Asymmetric Load");configureAsymmetricLoadAttributes(e,f,{name:`${n}`,p_a_mw:`${a}`,q_a_mvar:`${i}`,p_b_mw:`${s}`,q_b_mvar:`${l}`,p_c_mw:`${c}`,q_c_mvar:`${d}`,sn_mva:`${y}`,scaling:`${_}`,in_service:`${g}`,type:`${h}`}),u&&e.insertEdge(P,null,"",f,u,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),u.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y]=t,_=m.data[o][0],g=m.data[a][0],h=findVertexByBusId(e,P,_),p=findVertexByBusId(e,P,g);if(h&&p){let t="pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.miscellaneous.impedance;shapeELXXX=Impedance";const r=e.insertEdge(P,null,n,h,p,t);configureImpedanceAttributes(e,r,{name:`${n}`,from_bus:`${o}`,to_bus:`${a}`,rft_pu:`${i}`,xft_pu:`${s}`,rtf_pu:`${l}`,xtf_pu:`${c}`,sn_mva:`${d}`,in_service:`${y}`})}else console.warn(`Could not create impedance ${n}: Bus vertices not found`,{from_bus:_,to_bus:g,fromBusVertex:h,toBusVertex:p})}),x.data.forEach((t,r)=>{const[n,o,a,i,s,l,c]=t;let d=m.data[o][0];const y=findVertexByBusId(e,P,d),_=y.geometry.x+60,g=y.geometry.y+60,h=e.insertVertex(P,null,"",_,g,30,20,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.signal_sources.signal_ground;shapeELXXX=Ward");configureWardAttributes(e,h,{name:`${n}`,ps_mw:`${a}`,qs_mvar:`${i}`,qz_mvar:`${s}`,pz_mw:`${l}`,in_service:`${c}`}),y&&e.insertEdge(P,null,"",h,y,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),$.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g]=t;let h=m.data[o][0];const p=findVertexByBusId(e,P,h),u=p.geometry.x+60,x=p.geometry.y+60,$=e.insertVertex(P,null,"",u,x,30,20,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.miscellaneous.extended_ward;shapeELXXX=Extended Ward");configureExtendedWardAttributes(e,$,{name:`${n}`,ps_mw:`${a}`,qs_mvar:`${i}`,qz_mvar:`${s}`,pz_mw:`${l}`,r_ohm:`${c}`,x_ohm:`${d}`,vm_pu:`${y}`,slack_weight:`${_}`,in_service:`${g}`}),p&&e.insertEdge(P,null,"",$,p,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),f.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h,p]=t;let u=m.data[o][0];const x=findVertexByBusId(e,P,u),$=x.geometry.x+60,f=x.geometry.y+60,v=e.insertVertex(P,null,"",$,f,30,20,"shapeELXXX=Motor;verticalLabelPosition=middle;shadow=0;dashed=0;align=center;html=1;verticalAlign=middle;strokeWidth=1;shape=ellipse;fontSize=32;perimeter=ellipsePerimeter;");configureMotorAttributes(e,v,{name:`${n}`,bus_no:`${o}`,pn_mech_mw:`${a}`,loading_percent:`${i}`,cos_phi:`${s}`,cos_phi_n:`${l}`,efficiency_percent:`${c}`,efficiency_n_percent:`${d}`,lrc_pu:`${y}`,vn_kv:`${_}`,scaling:`${g}`,in_service:`${h}`,rx:`${p}`}),x&&e.insertEdge(P,null,"",v,x,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),v.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g]=t;let h=m.data[o][0];const p=findVertexByBusId(e,P,h),u=p.geometry.x+60,x=p.geometry.y+60,$=e.insertVertex(P,null,"",u,x,30,20,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.miscellaneous.multicell_battery;shapeELXXX=Storage");configureStorageAttributes(e,$,{name:`${n}`,bus_no:`${o}`,p_mw:`${a}`,q_mvar:`${i}`,sn_mva:`${s}`,soc_percent:`${l}`,min_e_mwh:`${c}`,max_e_mwh:`${d}`,scaling:`${y}`,in_service:`${_}`,type:`${g}`}),p&&e.insertEdge(P,null,"",$,p,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),X.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g]=t;let h=m.data[o][0];const p=findVertexByBusId(e,P,h),u=p.geometry.x+60,x=p.geometry.y+60,$=e.insertVertex(P,null,"",u,x,30,20,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.miscellaneous.svc;shapeELXXX=SVC");configureSVCAttributes(e,$,{name:`${n}`,bus_no:`${o}`,x_l_ohm:`${a}`,x_cvar_ohm:`${i}`,set_vm_pu:`${s}`,thyristor_firing_angle_degree:`${l}`,controllable:`${c}`,in_service:`${d}`,min_angle_degree:`${y}`,max_angle_degree:`${_}`,type:`${g}`}),p&&e.insertEdge(P,null,"",$,p,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),b.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y]=t;let _=m.data[o][0],g=m.data[a][0];const h=findVertexByBusId(e,P,_),p=findVertexByBusId(e,P,g),u=h.geometry.x+60,x=p.geometry.y-120,$=e.insertVertex(P,null,"",u,x,40,60,"pointerEvents=1;verticalLabelPosition=bottom;shadow=0;dashed=0;align=center;html=1;verticalAlign=top;shape=mxgraph.electrical.miscellaneous.tcsc;shapeELXXX=TCSC");configureTCSCAttributes(e,$,{name:`${n}`,from_bus_no:`${o}`,to_bus_no:`${a}`,x_l_ohm:`${i}`,x_cvar_ohm:`${s}`,set_p_to_mw:`${l}`,thyristor_firing_angle_degree:`${c}`,controllable:`${d}`,in_service:`${y}`}),h&&e.insertEdge(P,null,"",$,h,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.3;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine"),p&&e.insertEdge(P,null,"",$,p,"edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.4;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;;shapeELXXX=NotEditableLine")}),E.data.forEach((t,r)=>{const[n,o,a,i,s,l,c,d,y,_,g,h,p,u]=t,x=m.data[o][0],$=m.data[a][0],f=findVertexByBusId(e,P,x),v=findVertexByBusId(e,P,$);if(f&&v){let t="shapeELXXX=DC Line;text;html=1;strokeColor=black;fillColor=white;overflow=fill;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;";const r=e.insertEdge(P,null,n,f,v,t);configureDCLineAttributes(e,r,{name:`${n}`,from_bus:`${o}`,to_bus:`${a}`,p_mw:`${i}`,loss_percent:`${s}`,loss_mw:`${l}`,vm_from_pu:`${c}`,vm_to_pu:`${d}`,max_p_mw:`${y}`,min_q_from_mvar:`${_}`,min_q_to_mvar:`${g}`,max_q_from_mvar:`${h}`,max_q_to_mvar:`${p}`,in_service:`${u}`})}else console.warn(`Could not create line ${n}: Bus vertices not found`,{from_bus:x,to_bus:$,fromBusVertex:f,toBusVertex:v})})}catch(e){console.error("Error during vertex insertion:",e)}finally{e.getModel().endUpdate()}}