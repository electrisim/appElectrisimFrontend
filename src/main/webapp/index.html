<!--  [if IE]><meta http-equiv="X-UA-Compatible" content="IE=5" ><![endif]-->
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="mxgraph/css/common.css"> 
    
    <script type="text/javascript">
        window.mxBasePath = 'mxgraph';
        window.mxClient = { basePath: 'mxgraph' };
    </script>
    

    <script type="module" src="js/electrisim/config/environment.js"></script>

    <!-- Smartlook -->
    <script type='text/javascript'>
        window.smartlook||(function(d) {
            var o=smartlook=function(){ o.api.push(arguments)},h=d.getElementsByTagName('head')[0];
            var c=d.createElement('script');o.api=new Array();c.async=true;c.type='text/javascript';
            c.charset='utf-8';c.src='https://web-sdk.smartlook.com/recorder.js';h.appendChild(c);
        })(document);
        smartlook('init', '31f78a73918844d1c038266ca853b5b9bd7da408', { region: 'eu' });
    </script>

    <title>Electrisim - Model, Simulate And Analyse Power System With the Free Cloud App</title>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="Description" content="open-source online application for modelling, simulation and analysis of power system">
    <meta name="Keywords" content="electrical analysis, power system, simulation, load flow, short circuit">
    <meta itemprop="name" content="app.electrisim.com - open-source online application for electrical system">
    <meta itemprop="description" content="open-source online application for modelling, simlulation and analysis of power system">
    <meta itemprop="image" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="msapplication-config" content="images/browserconfig.xml">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#48d800">

    <script type="text/javascript">
        // URL Parameters handling
        var urlParams = (function() {
            var result = new Object();
            var params = window.location.search.slice(1).split('&');
            for (var i = 0; i < params.length; i++) {
                idx = params[i].indexOf('=');
                if (idx > 0) {
                    result[params[i].substring(0, idx)] = params[i].substring(idx + 1);
                }
            }
            return result;
        })();

        // Forces CDN caches by passing URL parameters via URL hash
        if (window.location.hash != null && window.location.hash.substring(0, 2) == '#P') {
            try {
                urlParams = JSON.parse(decodeURIComponent(window.location.hash.substring(2)));
                if (urlParams.hash != null) {
                    window.location.hash = urlParams.hash;
                }
            } catch (e) {
                // ignore
            }
        }

        // Global variables
        var mxIsElectron = window && window.process && window.process.type;

		// Redirects page if required
		if (urlParams['dev'] != '1')
		{
			(function()
			{
				var proto = window.location.protocol;
				
				if (!mxIsElectron)
				{
					var host = window.location.host;
		
					// Redirects apex, drive and rt to www
					if (host === 'draw.io' || host === 'rt.draw.io' || host === 'drive.draw.io')
					{
						host = 'www.draw.io';
					}
					
					var href = proto + '//' + host + window.location.href.substring(
							window.location.protocol.length +
							window.location.host.length + 2);
		
					// Redirects if href changes
					if (href != window.location.href)
					{
						window.location.href = href;
					}
				}
			})();
		}


		/**
		 * Adds meta tag to the page.
		 */
		 function mxmeta(name, content, httpEquiv)
		{
			try
			{
				var s = document.createElement('meta');
				
				if (name != null) 
				{
					s.setAttribute('name', name);
				}

				s.setAttribute('content', content);
				
				if (httpEquiv != null) 
				{
					s.setAttribute('http-equiv', httpEquiv);
				}

			  	var t = document.getElementsByTagName('meta')[0];
			  	t.parentNode.insertBefore(s, t);
			}
			catch (e)
			{
				// ignore
			}
		};      

        // Define mxGraph core dependencies
        const mxGraphDeps = [
            { src: 'mxgraph/mxClient.js' }
        ];

        // Define initialization scripts
        const initScripts = [
            { src: 'js/PreConfig.js' },
            { src: 'js/diagramly/Init.js' }
        ];

        // Define core scripts
        const coreScripts = [
            { src: 'js/json/json2.min.js' },
            { src: 'js/jscolor/jscolor.js' },
            { src: 'js/sanitizer/sanitizer.min.js' }
        ];

        // Define utility scripts
        const utilScripts = [
            { src: 'js/ag-grid-community.min.js' }
        ];

        // Define auth and subscription scripts (ES modules)
        const authScripts = [
            { src: 'https://js.stripe.com/v3/' },
            { src: 'js/electrisim/loginsubscription/stripe.js', type: 'module', async: true },
            { src: 'js/electrisim/loginsubscription/auth-handler.js', type: 'module', async: true },
            { src: 'js/electrisim/loginsubscription/stripe-subscription.js', type: 'module', async: true }
        ];

        // Define mxGraph scripts (dependent on mxClient)
        const mxGraphScripts = [
        //    { src: 'js/mxgraph/Init.js' }
        //    { src: 'js/mxgraph/Editor.js' },
         //   { src: 'js/mxgraph/Graph.js' },
        //    { src: 'js/mxgraph/Shapes.js' },
        //    { src: 'js/mxgraph/EditorUi.js' },
        //    { src: 'js/mxgraph/Actions.js' },
        //    { src: 'js/mxgraph/Toolbar.js' },
        //    { src: 'js/mxgraph/Menus.js' },
        //    { src: 'js/mxgraph/Format.js' },
        //    { src: 'js/mxgraph/Sidebar.js' },
        //    { src: 'js/mxgraph/Dialogs.js' }
        ];

        // Define application scripts (ES modules)
        const appScripts = [
            { src: 'js/app.min.js' },
           // { src: 'js/extensions.min.js' },
           // { src: 'js/shapes.min.js' },
            { src: 'js/electrisim/utils/cellUtils.js', type: 'module', async: true },
            { src: 'js/electrisim/dialogs/dialogInitializer.js', type: 'module', async: true },
            { src: 'js/electrisim/dialogs/EditDataDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/dialogs/LoadFlowDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/dialogs/ShortCircuitDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/lineBaseDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/lineDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/externalGridDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/generatorDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/staticGeneratorDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/asymmetricStaticGeneratorDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/busDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/transformerBaseDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/transformerDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/threeWindingTransformerBaseDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/threeWindingTransformerLibrary.js', type: 'module', async: true },
            { src: 'js/electrisim/shuntReactorDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/capacitorDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/loadDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/asymmetricLoadDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/shortCircuit.js', type: 'module', async: true },
            { src: 'js/electrisim/impedanceDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/wardDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/extendedWardDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/motorDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/storageDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/SSCDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/SVCDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/TCSCDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/dcLineDialog.js', type: 'module', async: true },
            { src: 'js/electrisim/configureAttributes.js', type: 'module', async: true },
            { src: 'js/electrisim/supportingFunctions.js', type: 'module', async: true },
            { src: 'js/electrisim/loadFlow.js', type: 'module', async: true },
            { src: 'js/electrisim/shortCircuit.js', type: 'module', async: true }
        ];

        function checkAllLoaded() {
            if (mxScriptsLoaded && mxWinLoaded) {
                try {
                    // Remove loading screen first
                    var geInfo = document.getElementById('geInfo');
                    if (geInfo != null) {
                        geInfo.parentNode.removeChild(geInfo);
                    }
                    
                    if (typeof App !== 'undefined' && App.main) {
                        App.main();
                    }
                } catch (e) {
                    console.error('Error in checkAllLoaded:', e);
                }
            }
        }

        function mxscript(src, onLoad, id, dataAppKey, noWrite, type) {
            type = type || 'text/javascript';
            var defer = onLoad == null && !noWrite;
            
            if ((urlParams['dev'] != '1' && typeof document.createElement('canvas').getContext === "function") ||
                onLoad != null || noWrite) {
                var s = document.createElement('script');
                s.setAttribute('type', type);
                s.setAttribute('src', src);
                if (defer) s.setAttribute('defer', 'true');
                if (id != null) s.setAttribute('id', id);
                if (dataAppKey != null) s.setAttribute('data-app-key', dataAppKey);
                
                if (onLoad != null) {
                    var r = false;
                    s.onload = s.onreadystatechange = function() {
                        if (!r && (!this.readyState || this.readyState == 'complete')) {
                            r = true;
                            onLoad();
                        }
                    };
                }
                
                var t = document.getElementsByTagName('script')[0];
                t.parentNode.insertBefore(s, t);
            } else {
                document.write('<script src="' + src + '"' + 
                    ((id != null) ? ' id="' + id +'" ' : '') +
                    ((dataAppKey != null) ? ' data-app-key="' + dataAppKey +'" ' : '') + 
                    '></scr' + 'ipt>');
            }
        }

		/**
		 * Asynchronously adds scripts to the page.
		 */
		 function mxinclude(src)
		{
			var g = document.createElement('script');
			g.type = 'text/javascript';
			g.async = true;
			g.src = src;
			
		    var s = document.getElementsByTagName('script')[0];
		    s.parentNode.insertBefore(g, s);
		};
        // Sequential script loading function
        function loadScriptSequence(scripts, onComplete) {
            let index = 0;
            function loadNext() {
                if (index < scripts.length) {
                    const script = scripts[index];
                    mxscript(script.src, function() {
                        index++;
                        loadNext();
                    }, null, null, false, script.type || 'text/javascript');
                } else if (onComplete) {
                    onComplete();
                }
            }
            loadNext();
        }

        // Custom loading system disabled to prevent conflicts with original draw.io loading
        // The original draw.io loading system below will handle all script loading
        /*
        // Start loading scripts
        (function() {
            // Load XLSX library first
            mxscript('https://unpkg.com/xlsx-style@0.8.13/dist/xlsx.full.min.js');

            // Load core dependencies
            loadScriptSequence(mxGraphDeps, function() {
                // Load initialization scripts
                loadScriptSequence(initScripts, function() {
                    // Load core scripts
                    loadScriptSequence(coreScripts, function() {
                        // Load utility scripts
                        loadScriptSequence(utilScripts, function() {
                            // Load auth scripts
                            loadScriptSequence(authScripts, function() {
                                // Load mxGraph scripts
                                loadScriptSequence(mxGraphScripts, function() {
                                    // Load application scripts
                                    loadScriptSequence(appScripts, function() {


                                        mxScriptsLoaded = true;
                                        checkAllLoaded();
                                    });
                                });
                            });
                        });
                    });
                });
            });

            var name = 'electrisim.com';
            mxmeta('apple-mobile-web-app-title', name);
            mxmeta('application-name', name);

            if (mxIsElectron) {
                mxmeta(null, 'default-src \'self\' \'unsafe-inline\'; connect-src \'self\' https://*.draw.io https://fonts.googleapis.com https://fonts.gstatic.com; img-src * data:; media-src *; font-src *; style-src-elem \'self\' \'unsafe-inline\' https://fonts.googleapis.com', 'Content-Security-Policy');
            }
        })();
        */
        
        // Meta tags for app
        var name = 'electrisim.com';
        mxmeta('apple-mobile-web-app-title', name);
        mxmeta('application-name', name);

        if (mxIsElectron) {
            mxmeta(null, 'default-src \'self\' \'unsafe-inline\'; connect-src \'self\' https://*.draw.io https://fonts.googleapis.com https://fonts.gstatic.com; img-src * data:; media-src *; font-src *; style-src-elem \'self\' \'unsafe-inline\' https://fonts.googleapis.com', 'Content-Security-Policy');
        }

		// Checks for local storage
		var isLocalStorage = false;
		
		try
		{
			isLocalStorage = urlParams['local'] != '1' && typeof(localStorage) != 'undefined';
		}
		catch (e)
		{
			// ignored
		}

		var mxScriptsLoaded = false, mxWinLoaded = false;
		
		window.onload = function() {
            mxWinLoaded = true;
            checkAllLoaded();
        };
		
		var t0 = new Date();

		// Changes paths for local development environment
		if (urlParams['dev'] == '1')
		{
			// Used to request grapheditor/mxgraph sources in dev mode
			var mxDevUrl = document.location.protocol + '//devhost.jgraph.com/mxgraph2';
			
			// Used to request draw.io sources in dev mode
			var drawDevUrl = document.location.protocol + '//devhost.jgraph.com/drawio/src/main/webapp/';
			
			if (document.location.protocol == 'file:')
			{
				mxDevUrl = '../../../../../mxgraph2';
				drawDevUrl = './';
				
				// Forces includes for dev environment in node.js
				mxForceIncludes = true;
			}
			

			var geBasePath = mxDevUrl + '/javascript/examples/grapheditor/www/js';
			var mxBasePath = mxDevUrl + '/javascript/src';
			
			mxscript(drawDevUrl + 'js/PreConfig.js');
			mxscript(drawDevUrl + 'js/diagramly/Init.js');
			mxscript(geBasePath + '/Init.js');
			mxscript(mxDevUrl + '/javascript/src/js/mxClient.js');
			
			// Adds all JS code that depends on mxClient. This indirection via Devel.js is
			// required in some browsers to make sure mxClient.js (and the files that it
			// loads asynchronously) are available when the code loaded in Devel.js runs.
			mxscript(drawDevUrl + 'js/diagramly/Devel.js');
			
			// Electron
			if (mxIsElectron)
			{
				mxscript('js/diagramly/DesktopLibrary.js');
				mxscript('js/diagramly/ElectronApp.js');
			}
			
			mxscript(drawDevUrl + 'js/PostConfig.js');
		}
		else
		{
			(function()
			{
				var hostName = window.location.hostname;
				
				// Supported domains are *.draw.io and the packaged version in Quip
				var supportedDomain = (hostName.substring(hostName.length - 8, hostName.length) === '.draw.io') ||
					(hostName.substring(hostName.length - 13, hostName.length) === '.diagrams.net');
					(hostName.substring(hostName.length - 17, hostName.length) === '.quipelements.com');

									
				function loadAppJS()				
				{
					// Load XLSX library first
					mxscript('https://unpkg.com/xlsx-style@0.8.13/dist/xlsx.full.min.js');

					// Load AG Grid library before app.min.js
					mxscript('js/ag-grid-community.min.js', function()
					{
						mxscript('js/app.min.js', function()
						{
							// Load Electrisim custom scripts after app.min.js
							var electrisimScripts = [
								'js/electrisim/utils/cellUtils.js',
								'js/electrisim/dialogs/dialogInitializer.js',
								'js/electrisim/dialogs/EditDataDialog.js',
								'js/electrisim/dialogs/LoadFlowDialog.js',
								'js/electrisim/dialogs/ShortCircuitDialog.js',
								'js/electrisim/lineBaseDialog.js',
								'js/electrisim/lineDialog.js',
								'js/electrisim/externalGridDialog.js',
								'js/electrisim/generatorDialog.js',
								'js/electrisim/staticGeneratorDialog.js',
								'js/electrisim/asymmetricStaticGeneratorDialog.js',
								'js/electrisim/busDialog.js',
								'js/electrisim/transformerBaseDialog.js',
								'js/electrisim/transformerDialog.js',
								'js/electrisim/threeWindingTransformerBaseDialog.js',
								'js/electrisim/threeWindingTransformerLibrary.js',
								'js/electrisim/shuntReactorDialog.js',
								'js/electrisim/capacitorDialog.js',
								'js/electrisim/loadDialog.js',
								'js/electrisim/asymmetricLoadDialog.js',
								'js/electrisim/shortCircuit.js',
								'js/electrisim/impedanceDialog.js',
								'js/electrisim/wardDialog.js',
								'js/electrisim/extendedWardDialog.js',
								'js/electrisim/motorDialog.js',
								'js/electrisim/storageDialog.js',
								'js/electrisim/SSCDialog.js',
								'js/electrisim/SVCDialog.js',
								'js/electrisim/TCSCDialog.js',
								'js/electrisim/dcLineDialog.js',
								'js/electrisim/configureAttributes.js',
								'js/electrisim/supportingFunctions.js',
								'js/electrisim/loadFlow.js'
							];
							
							// Load auth scripts first
							var authScripts = [
								'https://js.stripe.com/v3/',
								'js/electrisim/loginsubscription/stripe.js',
								'js/electrisim/loginsubscription/auth-handler.js',
								'js/electrisim/loginsubscription/stripe-subscription.js'
							];
							
							function loadAuthScripts(index) {
								if (index < authScripts.length) {
									var script = document.createElement('script');
									if (index > 0) script.type = 'module';
									script.src = authScripts[index];
									script.onload = function() {
										loadAuthScripts(index + 1);
									};
									script.onerror = function() {
										// Continue loading even if one fails
										loadAuthScripts(index + 1);
									};
									document.head.appendChild(script);
								} else {
									// Start loading Electrisim scripts
									loadElectrisimScripts(0);
								}
							}
							
							// Improved Electrisim script loading with better error handling
							function loadElectrisimScripts(index) {
								if (index < electrisimScripts.length) {
									var script = document.createElement('script');
									script.type = 'module';
									script.src = electrisimScripts[index];
									script.onload = function() {
										loadElectrisimScripts(index + 1);
									};
									script.onerror = function() {
										// Continue loading even if one fails
										loadElectrisimScripts(index + 1);
									};
									document.head.appendChild(script);
								} else {
									// Don't remove loading screen here - let the core app handle it
									// The core draw.io app will remove the loading screen when ready
									mxScriptsLoaded = true;
									checkAllLoaded();
								}
							}
							
							// Start loading auth scripts with a small delay to ensure app.min.js is fully initialized
							setTimeout(function() {
								loadAuthScripts(0);
							}, 10); // Minimal delay for initialization
							
							if (!supportedDomain)
							{
								mxscript('js/PostConfig.js');
							}
							
							// Electron
							if (mxIsElectron)
							{
								mxscript('js/diagramly/DesktopLibrary.js', function()
								{
									mxscript('js/diagramly/ElectronApp.js', function()
									{
										mxscript('js/extensions.min.js', function()
										{
											mxscript('js/stencils.min.js', function()
											{
												mxscript('js/shapes.min.js', function()
												{
													mxscript('js/PostConfig.js');
												});
											});
										});
									});
								});
							}
						});
					});
				};
				
				if (!supportedDomain || mxIsElectron)
				{
					mxscript('js/PreConfig.js', loadAppJS);
				}
				else
				{
					loadAppJS();
				}
			})();
		}

        // Basic error handling
        window.onerror = function() {
            var status = document.getElementById('geStatus');
            if (status != null) {
                status.innerHTML = 'Page is loading.';
            }
        };
    </script>

    <link rel="chrome-webstore-item" href="https://chrome.google.com/webstore/detail/plgmlhohecdddhbmmkncjdmlhcmaachm">
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/logo_Electrisim_removebg-preview.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/logo_Electrisim_removebg-preview.png">
    <link rel="mask-icon" href="images/safari-pinned-tab.svg" color="#d89000">
    <link rel="stylesheet" type="text/css" href="js/croppie/croppie.min.css">
    <link rel="stylesheet" type="text/css" href="mxgraph/css/common.css">
    <link rel="stylesheet" type="text/css" href="styles/grapheditor.css">
    <link rel="preconnect" href="https://storage.googleapis.com">
    <link rel="canonical" href="https://app.electrisim.com">
    <link rel="manifest" href="images/manifest.json">
    <link rel="shortcut icon" href="images/logo_Electrisim_removebg-preview.png">
    <style type="text/css">
        body { overflow:hidden; }
        div.picker { z-index: 10007; }
        .geSidebarContainer .geTitle input {
            font-size:8pt;
            color:#606060;
        }
        .geBlock {
            z-index:-3;
            margin:100px;
            margin-top:40px;
            margin-bottom:30px;
            padding:20px;
        }
        .geBlock h1, .geBlock h2 {
            margin-top:0px;
            padding-top:0px;
        }
        
        .geEditor ::-webkit-scrollbar {
            width:14px;
            height:14px;
        }
        .geEditor ::-webkit-scrollbar-track {
            background-clip:padding-box;
            border:solid transparent;
            border-width:1px;
        }
        .geEditor ::-webkit-scrollbar-corner {
            background-color:transparent;
        }
        .geEditor ::-webkit-scrollbar-thumb {
            background-color:rgba(0,0,0,.1);
            background-clip:padding-box;
            border:solid transparent;
            border-radius:10px;
        }
        .geEditor ::-webkit-scrollbar-thumb:hover{
            background-color:rgba(0,0,0,.4);
        }
    </style>
    <!--[if (IE 9)|(IE 10)]><!-->
    <script type="text/vbscript">
        Function mxUtilsBinaryToArray(Binary)
            Dim i
            ReDim byteArray(LenB(Binary))
            For i = 1 To LenB(Binary)
                byteArray(i-1) = AscB(MidB(Binary, i, 1))
            Next
            mxUtilsBinaryToArray = byteArray
        End Function
    </script>
    <!--<![endif]-->
</head>
<body class="geEditor">
    <div id="geInfo">
        <div class="geBlock" style="text-align:center;min-width:50%;">
            <h1>Electrisim - open-source app for power system modelling, simulation and analysis</h1>
            <h2 id="geStatus">Working only in a desktop web browser. <u>Not working on mobile phones.</u></h2>
            <p>
                app.electrisim.com is open-source online application for modelling, simulation and analysis of power system.
            </p>
            <p>
                Loading...
            </p>
            <p>
                Please ensure JavaScript is enabled. Tested on Google Chrome.
            </p>
        </div>
    </div>
</body>
</html>